[ source $CASA_SRC ]
  brainvisa opensource $CASA_BRANCH
  brainvisa brainvisa-installer $CASA_BRANCH
[ if os.getenv('WINEARCH') in ('win32', 'win64') ]
  - communication:web
[ endif ]

[ build $CASA_BUILD ]
[ if os.getenv('WINEARCH') in ('win32', 'win64') ]
  cmake_options = -DBRAINVISA_CROSSCOMPILATION_DIR=$CASA_DEPS
[ if os.getenv('WINEARCH') == 'win32' ]
  cross_compiling_prefix = i686-w64-mingw32
[ else ]
[if os.getenv('WINEARCH') == 'win64' ]
  cross_compiling_prefix = x86_64-w64-mingw32
[ endif ]
[ endif ]
[ endif ]
  default_steps = configure build doc
  make_options = -j4
  build_type = Release
  packaging_thirdparty = OFF
  clean_config = ON
  clean_build = ON
  test_ref_data_dir = $CASA_TESTS/ref
  test_run_data_dir = $CASA_TESTS/test
  brainvisa opensource $CASA_BRANCH $CASA_SRC
  - morphologist-ui
  - morphologist
  - nuclear_imaging
  - connectomist
  - cortical_surface
[ if os.getenv('WINEARCH') in ('win32', 'win64') ]
  - communication:web
[ endif ]

